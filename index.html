
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ZeroX</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div style="position: absolute; top: 12px; right: 12px;" id="themeContainer">
    <label style="font-size: 0.9em;">
      <input type="checkbox" id="themeSwitcher" />
      🌙 Dark Mode
    </label>
  </div>
  <div class="container">
    <h1>ZeroX</h1>
    <p>Click below to start chatting with a random stranger.</p>

    <button id="connectBtn">Connect to Stranger</button>
    
    <div id="geoMsg" style="margin-top: 20px; font-style: italic;"></div>

    
  </div>

  <script>
        // Auto-detect
    fetch('https://get.geojs.io/v1/ip/geo.json')
      .then(res => res.json())
      .then(data => {
        const countryCode = data.country_code?.toLowerCase();
        const countryName = data.country;
        document.getElementById("geoMsg").innerText = `🌐 You appear to be in ${countryName} (${countryCode.toUpperCase()})`;
        localStorage.setItem("country", countryCode || "any");
      })
      .catch(() => {
        localStorage.setItem("country", "any");
      });

    const lang = navigator.language || navigator.userLanguage;
    localStorage.setItem("language", lang.slice(0, 2).toLowerCase());

    document.getElementById("connectBtn").addEventListener("click", () => {
      
    document.body.innerHTML = '<div style="height:100vh;display:flex;align-items:center;justify-content:center;font-size:1.5em;">🔄 Connecting you to a stranger...</div>';
    setTimeout(() => {
      window.location.href = "chat.html?mode=video";
    }, 1000);
    
    });
  
    const switcher = document.getElementById("themeSwitcher");
    const body = document.body;
    const theme = localStorage.getItem("theme");

    if (theme === "dark") {
      body.classList.add("dark");
      switcher.checked = true;
    }

    switcher?.addEventListener("change", () => {
      if (switcher.checked) {
        body.classList.add("dark");
        localStorage.setItem("theme", "dark");
      } else {
        body.classList.remove("dark");
        localStorage.setItem("theme", "light");
      }
    });

    const switcher = document.getElementById("themeSwitcher");
    const body = document.body;
    const storedTheme = localStorage.getItem("theme");
    const systemPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

    if (storedTheme === "dark" || (!storedTheme && systemPrefersDark)) {
      body.classList.add("dark");
      switcher.checked = true;
    }

    switcher?.addEventListener("change", () => {
      if (switcher.checked) {
        body.classList.add("dark");
        localStorage.setItem("theme", "dark");
      } else {
        body.classList.remove("dark");
        localStorage.setItem("theme", "light");
      }
    });
</script>
</body>
</html>
